# Rust 区块链项目

这是一个用 Rust 语言实现的简单区块链演示项目，展示了区块链的基本概念和运作原理。

## 功能特性

- ✅ **区块结构**：完整的区块头和交易数据结构
- ✅ **区块链管理**：区块链的创建、验证和维护
- ✅ **交易系统**：交易的创建、验证和处理
- ✅ **工作量证明**：基于哈希的挖矿算法 (PoW)
- ✅ **权益证明**：基于质押的共识算法 (PoS)
- ✅ **委托权益证明**：基于投票的共识算法 (DPoS)
- ✅ **账户余额**：简单的账户余额跟踪系统
- ✅ **区块链验证**：完整的区块链完整性验证
- ✅ **数据持久化**：区块链状态的保存和加载（JSON格式）
- ✅ **CLI 用户界面**：交互式命令行界面，支持各种操作
- ✅ **Solana 智能合约**：集成 Solana 区块链的智能合约示例
- ✅ **P2P 网络通信**：节点间通信、交易和区块广播

## 项目结构

```
src/
├── main.rs           # 主程序入口
├── cli.rs            # CLI 用户界面模块
├── block.rs          # 区块结构体和方法
├── blockchain.rs     # 区块链逻辑和操作
├── consensus.rs      # 共识算法实现 (PoW/PoS/DPoS)
├── solana_program.rs # Solana 智能合约示例
├── p2p_node.rs       # P2P 网络通信模块
└── mod.rs            # 模块声明（自动生成）

blockchain.json       # 区块链持久化数据文件（运行后生成）
```

## 核心概念

### 区块 (Block)
- 包含区块头信息（时间戳、前区块哈希、当前哈希、nonce、难度）
- 存储交易列表
- 通过挖矿产生有效的哈希值

### 区块链 (Blockchain)
- 管理区块的链式结构
- 处理待处理的交易
- 维护账户余额
- 验证区块链完整性

### 交易 (Transaction)
- 记录转账信息
- 包含发送者、接收者和金额
- 每个交易都有唯一ID

### 挖矿 (Mining)
- 工作量证明机制
- 寻找合适的nonce值使区块哈希满足难度要求
- 矿工获得挖矿奖励

### 数据持久化 (Persistence)
- 使用JSON格式保存区块链状态到文件
- 程序启动时自动从文件加载现有区块链
- 支持完整的状态恢复，包括区块、交易和余额

### Solana 智能合约 (Solana Smart Contracts)
- 使用 Rust 编写 Solana 区块链程序
- 实现基本的账户转账功能
- 包含完整的错误处理和安全检查
- 提供部署指南和学习资源

### P2P 网络通信 (P2P Networking)
- 基于 TCP 的节点间通信
- 支持交易和区块广播
- 节点发现和心跳机制
- 消息序列化和反序列化
- 线程安全的并发处理

### 共识算法 (Consensus Algorithms)
- **PoW (Proof of Work)**：基于计算能力的传统挖矿
- **PoS (Proof of Stake)**：基于代币质押的权益证明
- **DPoS (Delegated Proof of Stake)**：基于投票的委托权益证明
- 支持动态切换不同的共识机制
- 完整的质押和委托管理功能

## 运行项目

```bash
# 克隆项目
git clone <repository-url>
cd blockchain_project

# 安装依赖
cargo build

# 运行 CLI 界面
cargo run

# 构建项目
cargo build --release
```

## CLI 界面使用

程序运行后会显示交互式菜单，提供以下操作：

1. **添加交易**：输入发送者、接收者和金额来创建交易
2. **挖矿**：输入矿工地址来挖矿待处理交易
3. **查看余额**：输入地址查看账户余额
4. **查看区块链**：显示完整的区块链信息
5. **验证区块链**：检查区块链完整性
6. **保存区块链**：将当前状态保存到文件
7. **Solana 智能合约演示**：查看 Solana 智能合约示例和部署指南
8. **P2P 网络操作**：管理 P2P 节点和网络通信
9. **共识算法管理**：切换和管理不同的共识算法
10. **退出**：结束程序

**共识算法管理**（选择 9）提供以下子功能：
- 切换到 PoW (工作量证明)
- 切换到 PoS (权益证明)
- 切换到 DPoS (委托权益证明)
- PoS 质押管理（质押、取消质押、查看质押信息）
- DPoS 候选人管理（注册候选人、委托投票、查看候选人）

**P2P 网络操作**（选择 8）提供以下子功能：
- 启动 P2P 节点
- 连接到其他节点
- 查看对等节点列表
- 广播交易到网络
- 广播区块到网络

程序启动时会自动加载 `blockchain.json` 文件（如果存在），否则创建新区块链。新创建的区块链会给 "system" 账户 1000 单位的初始余额，用于演示交易功能。

## 技术栈

- **Rust**：系统编程语言
- **SHA-256**：哈希算法（来自 sha2 crate）
- **Chrono**：时间戳处理
- **Serde**：数据序列化
- **Tokio**：异步运行时和网络库
- **Bincode**：二进制序列化
- **Solana Program Library**：Solana 智能合约开发框架

## 学习要点

通过这个项目，你可以学习到：
- Rust 结构体和实现的定义
- 所有权和借用概念的应用
- 错误处理（Result 和 Option）
- 模块系统的使用
- 区块链的基本工作原理

## 扩展建议

你可以考虑添加以下功能：
- __添加数字签名__ - 使用 RSA 或 ECDSA 
- __实现钱包功能__ - 密钥生成和管理 
- __增强网络协议__ - 完整的节点同步 
- __添加 Web 界面__ - 区块链浏览器 
- __集成数据库__ - 替代 JSON 文件存储


## 许可证

MIT License
